# Облачное хранилище МГТУ

Защищенная система облачного хранения файлов с контролем доступа на основе ролей, построенная на микросервисной архитектуре. Этот проект обеспечивает хранение файлов, управление пользователями, разрешениями и административные возможности.

## Обзор

Система состоит из двух основных микросервисов:
- **Сервис аутентификации**: Обрабатывает аутентификацию пользователей, авторизацию и управление разрешениями
- **Файловый сервис**: Управляет файловыми операциями, структурой папок и хранением

Проект также включает фронтенд-приложение, построенное с использованием Svelte и Astro.

## Функции

### Управление пользователями
- Регистрация и аутентификация пользователей с JWT
- Система контроля доступа на основе ролей
- Управление разрешениями
- Группы пользователей для организации доступа

### Управление файлами
- Загрузка и скачивание файлов
- Создание папок и организация файловой структуры
- Перемещение файлов между папками
- Операции с несколькими файлами (удаление, перемещение)
- Поддержка drag and drop

### Администрирование
- Административная панель с системной статистикой
- Мониторинг активности пользователей
- Аналитика использования хранилища
- Визуализация распределения типов файлов

## Архитектура

### Сервис аутентификации
- Построен на C++ с использованием фреймворка Drogon
- База данных PostgreSQL для хранения данных пользователей
- Аутентификация на основе JWT
- API для управления ролями и разрешениями

### Файловый сервис
- Построен на C++ с использованием фреймворка Drogon
- База данных PostgreSQL для метаданных файлов
- Файловая система для хранения фактических файлов
- Проверка разрешений через сервис аутентификации

### Фронтенд
- Построен с использованием Svelte и Astro
- Адаптивный дизайн с интерфейсом Material Design
- Поддержка темной/светлой темы
- Компоненты интерфейса в зависимости от роли пользователя

## Инструкции по установке

### Требования
- Компилятор C++ с поддержкой C++17
- PostgreSQL 14 или выше
- Node.js и npm
- CMake и Make

### Сборка и запуск

#### Сервис аутентификации
```bash
cd auth
mkdir build && cd build
cmake ..
make
./auth
```

#### Файловый сервис
```bash
cd fileservice
mkdir build && cd build
cmake ..
make
./fileservice
```

#### Фронтенд
```bash
cd frontend
npm install
npm run dev  # Разработка
npm run build  # Сборка для продакшена
```

### Конфигурация
- Оба сервиса используют файлы `config.json` для конфигурации
- JWT ключи должны быть размещены в директории `/keys`
- Параметры подключения к базе данных можно настроить в файлах конфигурации

## Документация API

### Эндпоинты сервиса аутентификации
- `POST /api/v1/signup`: Создание нового пользователя
- `POST /api/v1/login`: Аутентификация пользователя и получение JWT
- `GET /api/v1/users/{user_id}/roles`: Получение ролей пользователя
- `POST /api/v1/role`: Создание новой роли
- `GET /api/v1/admin/users`: Список всех пользователей (только для администраторов)

### Эндпоинты файлового сервиса
- `GET /api/v1/files`: Список файлов в папке
- `POST /api/v1/files`: Загрузка файлов
- `GET /api/v1/folders`: Список папок
- `POST /api/v1/folders`: Создание папок
- `DELETE /api/v1/files`: Удаление файлов
- `GET /api/v1/admin/stats`: Получение системной статистики (только для администраторов)

## Безопасность

Система реализует несколько функций безопасности:
- Аутентификация на основе JWT с алгоритмом RS256
- Контроль доступа на основе ролей
- Проверка разрешений для всех операций
- Безопасная валидация имен файлов
- Межсервисная аутентификация

## Лицензия

[Вставьте вашу информацию о лицензии здесь]